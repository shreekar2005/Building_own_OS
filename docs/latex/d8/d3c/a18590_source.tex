\doxysubsection{kmemory.\+cpp}
\hypertarget{a18590_source}{}\label{a18590_source}\index{/home/shreekar/Desktop/Building\_own\_OS/OSOS/libk\_src/basic/kmemory.cpp@{/home/shreekar/Desktop/Building\_own\_OS/OSOS/libk\_src/basic/kmemory.cpp}}
\mbox{\hyperlink{a18590}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{a18590_source_l00001}00001\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{a18563}{basic/kmemory.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{a18590_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{a18590_source_l00005}\mbox{\hyperlink{a18618_a53c6425a55d9fb93998da01f2416f9ad}{00005}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{a18618_a53c6425a55d9fb93998da01f2416f9ad}{basic::\_\_printMemoryMap}}(multiboot\_info\_t\ *mbi)}
\DoxyCodeLine{\Hypertarget{a18590_source_l00006}00006\ \{}
\DoxyCodeLine{\Hypertarget{a18590_source_l00007}00007\ \ \ \ \ \textcolor{comment}{//\ Check\ if\ the\ memory\ map\ flag\ is\ set\ (bit\ 6)}}
\DoxyCodeLine{\Hypertarget{a18590_source_l00008}00008\ \ \ \ \ \textcolor{keywordflow}{if}\ (!(mbi-\/>flags\ \&\ (1\ <<\ 6)))\ \{}
\DoxyCodeLine{\Hypertarget{a18590_source_l00009}00009\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{a18618_a45ee52b918a784ff0e96e7c8917a91d9}{basic::printf}}(\textcolor{stringliteral}{"{}\(\backslash\)nError:\ Memory\ map\ not\ provided\ by\ bootloader.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{a18590_source_l00010}00010\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{a18590_source_l00011}00011\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{a18590_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{a18590_source_l00013}00013\ \ \ \ \ \mbox{\hyperlink{a18618_a45ee52b918a784ff0e96e7c8917a91d9}{basic::printf}}(\textcolor{stringliteral}{"{}\(\backslash\)n-\/-\/-\/\ System\ Memory\ Map\ -\/-\/-\/\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{a18590_source_l00014}00014\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{a18590_source_l00015}00015\ \ \ \ \ \textcolor{comment}{//\ Use\ uint64\_t\ to\ correctly\ accumulate\ total\ memory\ size}}
\DoxyCodeLine{\Hypertarget{a18590_source_l00016}00016\ \ \ \ \ uint64\_t\ total\_available\_bytes\ =\ 0;}
\DoxyCodeLine{\Hypertarget{a18590_source_l00017}00017\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{a18590_source_l00018}00018\ \ \ \ \ \textcolor{comment}{//\ Use\ uintptr\_t\ for\ pointer\ arithmetic\ to\ ensure\ portability}}
\DoxyCodeLine{\Hypertarget{a18590_source_l00019}00019\ \ \ \ \ uintptr\_t\ mmap\_start\ =\ mbi-\/>mmap\_addr;}
\DoxyCodeLine{\Hypertarget{a18590_source_l00020}00020\ \ \ \ \ uintptr\_t\ mmap\_end\ =\ mbi-\/>mmap\_addr\ +\ mbi-\/>mmap\_length;}
\DoxyCodeLine{\Hypertarget{a18590_source_l00021}00021\ }
\DoxyCodeLine{\Hypertarget{a18590_source_l00022}00022\ \ \ \ \ \textcolor{keywordflow}{for}\ (multiboot\_memory\_map\_t\ *mmap\ =\ (multiboot\_memory\_map\_t\ *)mmap\_start;}
\DoxyCodeLine{\Hypertarget{a18590_source_l00023}00023\ \ \ \ \ \ \ \ \ \ (uintptr\_t)mmap\ <\ mmap\_end;}
\DoxyCodeLine{\Hypertarget{a18590_source_l00024}00024\ \ \ \ \ \ \ \ \ \ mmap\ =\ (multiboot\_memory\_map\_t\ *)((uintptr\_t)mmap\ +\ mmap-\/>size\ +\ \textcolor{keyword}{sizeof}(mmap-\/>size)))}
\DoxyCodeLine{\Hypertarget{a18590_source_l00025}00025\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{a18590_source_l00026}00026\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *type\_str;}
\DoxyCodeLine{\Hypertarget{a18590_source_l00027}00027\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (mmap-\/>type)}
\DoxyCodeLine{\Hypertarget{a18590_source_l00028}00028\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{a18590_source_l00029}00029\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{a18560_a7fe141351ebcde0acbd6118ad0ea1a21}{MULTIBOOT\_MEMORY\_AVAILABLE}}:}
\DoxyCodeLine{\Hypertarget{a18590_source_l00030}00030\ \ \ \ \ \ \ \ \ \ \ \ \ type\_str\ =\ \textcolor{stringliteral}{"{}Available"{}};}
\DoxyCodeLine{\Hypertarget{a18590_source_l00031}00031\ \ \ \ \ \ \ \ \ \ \ \ \ total\_available\_bytes\ +=\ mmap-\/>len;}
\DoxyCodeLine{\Hypertarget{a18590_source_l00032}00032\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{a18590_source_l00033}00033\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{a18560_a0299aedc71e1f6707181471bafb18e7c}{MULTIBOOT\_MEMORY\_RESERVED}}:}
\DoxyCodeLine{\Hypertarget{a18590_source_l00034}00034\ \ \ \ \ \ \ \ \ \ \ \ \ type\_str\ =\ \textcolor{stringliteral}{"{}Reserved"{}};}
\DoxyCodeLine{\Hypertarget{a18590_source_l00035}00035\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{a18590_source_l00036}00036\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{a18560_af35be82586f332a561d00207c937ee57}{MULTIBOOT\_MEMORY\_ACPI\_RECLAIMABLE}}:}
\DoxyCodeLine{\Hypertarget{a18590_source_l00037}00037\ \ \ \ \ \ \ \ \ \ \ \ \ type\_str\ =\ \textcolor{stringliteral}{"{}ACPI\ Reclaimable"{}};}
\DoxyCodeLine{\Hypertarget{a18590_source_l00038}00038\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{a18590_source_l00039}00039\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{a18560_a68f78286f7434d373a82f1b6f6473c72}{MULTIBOOT\_MEMORY\_NVS}}:}
\DoxyCodeLine{\Hypertarget{a18590_source_l00040}00040\ \ \ \ \ \ \ \ \ \ \ \ \ type\_str\ =\ \textcolor{stringliteral}{"{}NVS"{}};}
\DoxyCodeLine{\Hypertarget{a18590_source_l00041}00041\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{a18590_source_l00042}00042\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{a18560_a1604ec18ac949d88dab993904b08c075}{MULTIBOOT\_MEMORY\_BADRAM}}:}
\DoxyCodeLine{\Hypertarget{a18590_source_l00043}00043\ \ \ \ \ \ \ \ \ \ \ \ \ type\_str\ =\ \textcolor{stringliteral}{"{}Bad\ RAM"{}};}
\DoxyCodeLine{\Hypertarget{a18590_source_l00044}00044\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{a18590_source_l00045}00045\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{a18590_source_l00046}00046\ \ \ \ \ \ \ \ \ \ \ \ \ type\_str\ =\ \textcolor{stringliteral}{"{}Unknown"{}};}
\DoxyCodeLine{\Hypertarget{a18590_source_l00047}00047\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{a18590_source_l00048}00048\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{a18590_source_l00049}00049\ }
\DoxyCodeLine{\Hypertarget{a18590_source_l00050}00050\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Use\ \%\#llx\ for\ 64-\/bit\ hex\ values\ (address\ and\ length)}}
\DoxyCodeLine{\Hypertarget{a18590_source_l00051}00051\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{a18618_a45ee52b918a784ff0e96e7c8917a91d9}{basic::printf}}(\textcolor{stringliteral}{"{}Addr:\ \%\#llx\ |\ Len:\ \%.2fKB\ |\ Type:\ \%s\(\backslash\)n"{}},\ mmap-\/>addr,\ mmap-\/>len/1024.0,\ type\_str);}
\DoxyCodeLine{\Hypertarget{a18590_source_l00052}00052\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{a18590_source_l00053}00053\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{a18590_source_l00054}00054\ \ \ \ \ \textcolor{comment}{//\ Use\ floating\ point\ for\ the\ final\ calculation\ and\ display}}
\DoxyCodeLine{\Hypertarget{a18590_source_l00055}00055\ \ \ \ \ \textcolor{keywordtype}{double}\ total\_mb\ =\ total\_available\_bytes\ /\ 1024.0;}
\DoxyCodeLine{\Hypertarget{a18590_source_l00056}00056\ \ \ \ \ \mbox{\hyperlink{a18618_a45ee52b918a784ff0e96e7c8917a91d9}{basic::printf}}(\textcolor{stringliteral}{"{}Total\ available\ memory:\ \%.2f\ KB\(\backslash\)n\(\backslash\)n"{}},\ total\_mb);}
\DoxyCodeLine{\Hypertarget{a18590_source_l00057}00057\ \}}
\DoxyCodeLine{\Hypertarget{a18590_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{a18590_source_l00059}00059\ }
\DoxyCodeLine{\Hypertarget{a18590_source_l00070}\mbox{\hyperlink{a18590_a1a7f24760c8c7ad3bfcd54856d906fc2}{00070}}\ \textcolor{keywordtype}{void}*\ \textcolor{keyword}{operator}\ \textcolor{keyword}{new}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{a18560_a6d813a0f2b5281b18dea3f4cda696c33}{size}})\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{\Hypertarget{a18590_source_l00071}00071\ \ \ \ \ (void)\mbox{\hyperlink{a18560_a6d813a0f2b5281b18dea3f4cda696c33}{size}};}
\DoxyCodeLine{\Hypertarget{a18590_source_l00072}00072\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{a18590_source_l00073}00073\ \}}
\DoxyCodeLine{\Hypertarget{a18590_source_l00074}00074\ }
\DoxyCodeLine{\Hypertarget{a18590_source_l00078}\mbox{\hyperlink{a18590_aa75472ab4b765cf6f6b5b0ebcd4a28c8}{00078}}\ \textcolor{keywordtype}{void}*\ \textcolor{keyword}{operator}\ \textcolor{keyword}{new}[](\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{a18560_a6d813a0f2b5281b18dea3f4cda696c33}{size}})\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{\Hypertarget{a18590_source_l00079}00079\ \ \ \ \ (void)\mbox{\hyperlink{a18560_a6d813a0f2b5281b18dea3f4cda696c33}{size}};}
\DoxyCodeLine{\Hypertarget{a18590_source_l00080}00080\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{a18590_source_l00081}00081\ \}}
\DoxyCodeLine{\Hypertarget{a18590_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{a18590_source_l00085}\mbox{\hyperlink{a18590_afa145befcf5e7b83424408ca503c8637}{00085}}\ \textcolor{keywordtype}{void}\ \textcolor{keyword}{operator}\ \textcolor{keyword}{delete}(\textcolor{keywordtype}{void}*\ ptr)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{\Hypertarget{a18590_source_l00086}00086\ \ \ \ \ (void)ptr;}
\DoxyCodeLine{\Hypertarget{a18590_source_l00087}00087\ \}}
\DoxyCodeLine{\Hypertarget{a18590_source_l00088}00088\ }
\DoxyCodeLine{\Hypertarget{a18590_source_l00092}\mbox{\hyperlink{a18590_af057efbdbcd21ea12954d49cd2d245c6}{00092}}\ \textcolor{keywordtype}{void}\ \textcolor{keyword}{operator}\ \textcolor{keyword}{delete}(\textcolor{keywordtype}{void}*\ ptr,\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{a18560_a6d813a0f2b5281b18dea3f4cda696c33}{size}})\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{\Hypertarget{a18590_source_l00093}00093\ \ \ \ \ (void)ptr;}
\DoxyCodeLine{\Hypertarget{a18590_source_l00094}00094\ \ \ \ \ (void)\mbox{\hyperlink{a18560_a6d813a0f2b5281b18dea3f4cda696c33}{size}};}
\DoxyCodeLine{\Hypertarget{a18590_source_l00095}00095\ \}}
\DoxyCodeLine{\Hypertarget{a18590_source_l00096}00096\ }
\DoxyCodeLine{\Hypertarget{a18590_source_l00099}\mbox{\hyperlink{a18590_a22aea74a1155aa798d6032da46da2391}{00099}}\ \textcolor{keywordtype}{void}\ \textcolor{keyword}{operator}\ \textcolor{keyword}{delete}[](\textcolor{keywordtype}{void}*\ ptr)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{\Hypertarget{a18590_source_l00100}00100\ \ \ \ \ (void)ptr;}
\DoxyCodeLine{\Hypertarget{a18590_source_l00101}00101\ \}}
\DoxyCodeLine{\Hypertarget{a18590_source_l00102}00102\ }
\DoxyCodeLine{\Hypertarget{a18590_source_l00106}\mbox{\hyperlink{a18590_ab26fe706b29fdeb33d5f6ead76c05815}{00106}}\ \textcolor{keywordtype}{void}\ \textcolor{keyword}{operator}\ \textcolor{keyword}{delete}[](\textcolor{keywordtype}{void}*\ ptr,\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{a18560_a6d813a0f2b5281b18dea3f4cda696c33}{size}})\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{\Hypertarget{a18590_source_l00107}00107\ \ \ \ \ (void)ptr;}
\DoxyCodeLine{\Hypertarget{a18590_source_l00108}00108\ \ \ \ \ (void)\mbox{\hyperlink{a18560_a6d813a0f2b5281b18dea3f4cda696c33}{size}};}
\DoxyCodeLine{\Hypertarget{a18590_source_l00109}00109\ \}}

\end{DoxyCode}
