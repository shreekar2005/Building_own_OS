\doxysubsection{kgdt.\+hpp}
\hypertarget{a04367_source}{}\label{a04367_source}\index{libk\_header/essential/kgdt.hpp@{libk\_header/essential/kgdt.hpp}}
\mbox{\hyperlink{a04367}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{a04367_source_l00001}\mbox{\hyperlink{a04376_a52e3ec8c29cc4bb68f65445749f0bfdb}{00001}}\ \textcolor{preprocessor}{\#ifndef\ \_OSOS\_ESSENTIAL\_GDT\_H}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00002}\mbox{\hyperlink{a04367_ad516e6ff5b7dd7f6ce2946c527ddb8b9}{00002}}\ \textcolor{preprocessor}{\#define\ \_OSOS\_ESSENTIAL\_GDT\_H}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00003}\mbox{\hyperlink{a04367_a6b67e86f6de9204d76adab79069aec29}{00003}}\ }
\DoxyCodeLine{\Hypertarget{a04367_source_l00004}\mbox{\hyperlink{a04367_a8b0d6200bc639dd37ff68847a0adde5f}{00004}}\ \textcolor{preprocessor}{\ \ \ \ \#include\ <cstdint>}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00005}\mbox{\hyperlink{a04367_acfea365f69e71368a2db03333d4afd6f}{00005}}\ \textcolor{preprocessor}{\ \ \ \ \#include\ "{}\mbox{\hyperlink{a04346}{basic/kiostream.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00006}\mbox{\hyperlink{a04367_a1a173457c7aa39c59c008fcc3332d2b3}{00006}}\ }
\DoxyCodeLine{\Hypertarget{a04367_source_l00007}\mbox{\hyperlink{a04367_a137b4628cf352225e57720432f2db487}{00007}}\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/\ Flags\ for\ the\ 8-\/bit\ ACCESS\ BYTE\ -\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00008}\mbox{\hyperlink{a04367_a6c474d3015717ee1a2d99ae6a7b00ec3}{00008}}\ \textcolor{preprocessor}{\ \ \ \ \#define\ SEG\_ACCESS\_TYPE(x)\ \ ((x)\ <<\ 0)\ \ }\textcolor{comment}{//\ Type\ field\ (e.g.,\ SEG\_CODE\_EXRD)}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00009}\mbox{\hyperlink{a04367_a0d47ea941c3bdfd06858a467d2e76d83}{00009}}\ \textcolor{preprocessor}{\ \ \ \ \#define\ SEG\_ACCESS\_DESCTYPE(x)\ ((x)\ <<\ 4)\ }\textcolor{comment}{//\ Descriptor\ type\ (0=system,\ 1=code/data)}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00010}\mbox{\hyperlink{a04367_a24693ad4185e3f70d2be14a964474436}{00010}}\ \textcolor{preprocessor}{\ \ \ \ \#define\ SEG\_ACCESS\_PRIV(x)\ \ (((x)\ \&\ 0x03)\ <<\ 5)\ }\textcolor{comment}{//\ Privilege\ level\ (0-\/3)}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00011}\mbox{\hyperlink{a04367_ad6539f5ca5082793a69451b8c1fc6523}{00011}}\ \textcolor{preprocessor}{\ \ \ \ \#define\ SEG\_ACCESS\_PRES(x)\ \ ((x)\ <<\ 7)\ \ }\textcolor{comment}{//\ Present\ bit}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00012}\mbox{\hyperlink{a04367_a258db7c2f70fd1b20332ee3c00cd1d89}{00012}}\ }
\DoxyCodeLine{\Hypertarget{a04367_source_l00013}\mbox{\hyperlink{a04367_a0a72b35b5fcadccd545ee4c5ef7efdd3}{00013}}\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/\ Flags\ for\ the\ upper\ 4\ bits\ of\ the\ GRANULARITY\ BYTE\ -\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00014}\mbox{\hyperlink{a04367_a6aba53071c94f3ffe96befc625602c9c}{00014}}\ \textcolor{preprocessor}{\ \ \ \ \#define\ SEG\_GRAN\_SAVL(x)\ \ \ \ ((x)\ <<\ 4)\ \ }\textcolor{comment}{//\ Available\ for\ system\ use}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00015}\mbox{\hyperlink{a04367_a2dda285f5ad6336a22f9ff1d2d098e60}{00015}}\ \textcolor{preprocessor}{\ \ \ \ \#define\ SEG\_GRAN\_LONG(x)\ \ \ \ ((x)\ <<\ 5)\ \ }\textcolor{comment}{//\ Long\ mode\ (64-\/bit)}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00016}\mbox{\hyperlink{a04367_aaa6fbf4816b6af649fc82186fe18b4e0}{00016}}\ \textcolor{preprocessor}{\ \ \ \ \#define\ SEG\_GRAN\_SIZE(x)\ \ \ \ ((x)\ <<\ 6)\ \ }\textcolor{comment}{//\ Size\ (0=16-\/bit,\ 1=32-\/bit)}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00017}\mbox{\hyperlink{a04367_ae86357f11d481de7242f3178629241b8}{00017}}\ \textcolor{preprocessor}{\ \ \ \ \#define\ SEG\_GRAN\_GRAN(x)\ \ \ \ ((x)\ <<\ 7)\ \ }\textcolor{comment}{//\ Granularity\ (0=1B,\ 1=4KB\ pages)}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00018}\mbox{\hyperlink{a04367_a95dcc3ea7fb0310df8f2ab457deca483}{00018}}\ }
\DoxyCodeLine{\Hypertarget{a04367_source_l00019}00019\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/\ Segment\ Type\ Fields\ (for\ the\ access\ byte)\ -\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00020}\mbox{\hyperlink{a04367_add294548173871e30e54b92bf5da2758}{00020}}\ \textcolor{preprocessor}{\ \ \ \ \#define\ SEG\_DATA\_RDWR\ \ \ \ \ \ 0x02\ }\textcolor{comment}{//\ Read/Write}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00021}\mbox{\hyperlink{a04367_ae04daf26bdb792ae557ef1216021cc43}{00021}}\ \textcolor{preprocessor}{\ \ \ \ \#define\ SEG\_CODE\_EXRD\ \ \ \ \ \ 0x0A\ }\textcolor{comment}{//\ Execute/Read}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{a04367_source_l00023}00023\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/\ Correctly\ combined\ ACCESS\ byte\ values\ -\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00024}\mbox{\hyperlink{a04367_ac4461ee84aade9ee824de64d4846ec98}{00024}}\ \textcolor{preprocessor}{\ \ \ \ \#define\ GDT\_ACCESS\_CODE\_PL0\ SEG\_ACCESS\_PRES(1)\ |\ SEG\_ACCESS\_PRIV(0)\ |\ SEG\_ACCESS\_DESCTYPE(1)\ |\ SEG\_ACCESS\_TYPE(SEG\_CODE\_EXRD)}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00025}\mbox{\hyperlink{a04367_a1adfff1c72212b5c4e1df35485bb102a}{00025}}\ \textcolor{preprocessor}{\ \ \ \ \#define\ GDT\_ACCESS\_DATA\_PL0\ SEG\_ACCESS\_PRES(1)\ |\ SEG\_ACCESS\_PRIV(0)\ |\ SEG\_ACCESS\_DESCTYPE(1)\ |\ SEG\_ACCESS\_TYPE(SEG\_DATA\_RDWR)}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00026}\mbox{\hyperlink{a04367_a01d908c8637340b21274e0176b320c05}{00026}}\ \textcolor{preprocessor}{\ \ \ \ \#define\ GDT\_ACCESS\_CODE\_PL3\ SEG\_ACCESS\_PRES(1)\ |\ SEG\_ACCESS\_PRIV(3)\ |\ SEG\_ACCESS\_DESCTYPE(1)\ |\ SEG\_ACCESS\_TYPE(SEG\_CODE\_EXRD)}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00027}\mbox{\hyperlink{a04367_ac7f57dcdd84028460100b6da75ad4938}{00027}}\ \textcolor{preprocessor}{\ \ \ \ \#define\ GDT\_ACCESS\_DATA\_PL3\ SEG\_ACCESS\_PRES(1)\ |\ SEG\_ACCESS\_PRIV(3)\ |\ SEG\_ACCESS\_DESCTYPE(1)\ |\ SEG\_ACCESS\_TYPE(SEG\_DATA\_RDWR)}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{a04367_source_l00029}00029\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/\ Correctly\ combined\ GRANULARITY\ byte\ flags\ -\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00030}00030\ \ \ \ \ \textcolor{comment}{//\ For\ a\ 32-\/bit\ OS\ in\ protected\ mode\ with\ 4KB\ pages}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00031}\mbox{\hyperlink{a04367_a4941c819dbbef299c391bf53c24caf8d}{00031}}\ \textcolor{preprocessor}{\ \ \ \ \#define\ GDT\_GRAN\_FLAGS\ \ \ \ \ \ SEG\_GRAN\_GRAN(1)\ |\ SEG\_GRAN\_SIZE(1)\ |\ SEG\_GRAN\_LONG(0)\ |\ SEG\_GRAN\_SAVL(0)}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{a04367_source_l00033}\mbox{\hyperlink{a04376}{00033}}\ \ \ \ \ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{a04376}{essential}}\{}
\DoxyCodeLine{\Hypertarget{a04367_source_l00034}\mbox{\hyperlink{a05273}{00034}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{a05273}{GDT\_row}}\ \{}
\DoxyCodeLine{\Hypertarget{a04367_source_l00035}00035\ \ \ \ \ \ \ \ \ \ \ \ \ private\ :}
\DoxyCodeLine{\Hypertarget{a04367_source_l00036}\mbox{\hyperlink{a05273_a2bddbe405dfbbbd101c475bd1bd65112}{00036}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint16\_t\ \mbox{\hyperlink{a05273_a2bddbe405dfbbbd101c475bd1bd65112}{limit\_low}};}
\DoxyCodeLine{\Hypertarget{a04367_source_l00037}\mbox{\hyperlink{a05273_a298d18522898ad48c1e05b79f1f4dff7}{00037}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint16\_t\ \mbox{\hyperlink{a05273_a298d18522898ad48c1e05b79f1f4dff7}{base\_low}};}
\DoxyCodeLine{\Hypertarget{a04367_source_l00038}\mbox{\hyperlink{a05273_a8429e04bddc6a61c4e95b88901ae219d}{00038}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ \ \mbox{\hyperlink{a05273_a8429e04bddc6a61c4e95b88901ae219d}{base\_middle}};}
\DoxyCodeLine{\Hypertarget{a04367_source_l00039}\mbox{\hyperlink{a05273_a7f01a0febd325787f1ff47d6a3b668a9}{00039}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ \ \mbox{\hyperlink{a05273_a7f01a0febd325787f1ff47d6a3b668a9}{access}};}
\DoxyCodeLine{\Hypertarget{a04367_source_l00040}\mbox{\hyperlink{a05273_af180a640dbd5213b3f936ff7cf48deaf}{00040}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ \ \mbox{\hyperlink{a05273_af180a640dbd5213b3f936ff7cf48deaf}{granularity}};}
\DoxyCodeLine{\Hypertarget{a04367_source_l00041}\mbox{\hyperlink{a05273_a2cbd86d4258ecebf7b46cc9bb8611b5b}{00041}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ \ \mbox{\hyperlink{a05273_a2cbd86d4258ecebf7b46cc9bb8611b5b}{base\_high}};}
\DoxyCodeLine{\Hypertarget{a04367_source_l00042}00042\ }
\DoxyCodeLine{\Hypertarget{a04367_source_l00043}00043\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{a04367_source_l00044}00044\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Constructor\ now\ takes\ an\ 8-\/bit\ access\ byte\ and\ 8-\/bit\ granularity\ byte}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00045}00045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{a05273_a27ff8d9a6bf6c2c98cf78a0257e4667e}{GDT\_row}}(uint32\_t\ \mbox{\hyperlink{a04367_ad516e6ff5b7dd7f6ce2946c527ddb8b9}{base}},\ uint32\_t\ \mbox{\hyperlink{a04367_ab28e82ae69032cb4ad3ec3a0be3d7129}{limit}},\ uint8\_t\ access\_byte,\ uint8\_t\ gran\_byte);}
\DoxyCodeLine{\Hypertarget{a04367_source_l00046}00046\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{a05273_a27ff8d9a6bf6c2c98cf78a0257e4667e}{GDT\_row}}();\ \textcolor{comment}{//\ Default\ constructor\ for\ null\ segment}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00047}00047\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{a05273_a6eb69c55c0bd16040b2d766dd068df31}{\string~GDT\_row}}();}
\DoxyCodeLine{\Hypertarget{a04367_source_l00048}00048\ }
\DoxyCodeLine{\Hypertarget{a04367_source_l00049}00049\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Friend\ class\ to\ allow\ GDT\ to\ access\ private\ members\ for\ printing}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00050}\mbox{\hyperlink{a05273_a235097b2551abe03269f88341b4bdf87}{00050}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{a05277}{GDT}};}
\DoxyCodeLine{\Hypertarget{a04367_source_l00051}00051\ }
\DoxyCodeLine{\Hypertarget{a04367_source_l00052}00052\ \ \ \ \ \ \ \ \ \}\ \mbox{\hyperlink{a04340_a4bbf25084dee10ec29f4356cacced463}{\_\_attribute\_\_}}((packed));}
\DoxyCodeLine{\Hypertarget{a04367_source_l00053}00053\ }
\DoxyCodeLine{\Hypertarget{a04367_source_l00054}\mbox{\hyperlink{a05277}{00054}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{a05277}{GDT}}\ \{}
\DoxyCodeLine{\Hypertarget{a04367_source_l00055}00055\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{\Hypertarget{a04367_source_l00056}\mbox{\hyperlink{a05277_a4105a25a1ec71dc7e338639bb370c664}{00056}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint16\_t\ \mbox{\hyperlink{a05277_a4105a25a1ec71dc7e338639bb370c664}{limit}};}
\DoxyCodeLine{\Hypertarget{a04367_source_l00057}\mbox{\hyperlink{a05277_ad0a48a89930e6a6c4467c977f4e91269}{00057}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uintptr\_t\ \mbox{\hyperlink{a05277_ad0a48a89930e6a6c4467c977f4e91269}{base}};}
\DoxyCodeLine{\Hypertarget{a04367_source_l00058}\mbox{\hyperlink{a05277_a154c2e2725809d873c8e7d5f19ea66c5}{00058}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{a05273}{GDT\_row}}\ \mbox{\hyperlink{a05277_a154c2e2725809d873c8e7d5f19ea66c5}{nullSegment}};}
\DoxyCodeLine{\Hypertarget{a04367_source_l00059}\mbox{\hyperlink{a05277_a20d7a6bb352e3f696c1c68bb394766d8}{00059}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{a05273}{GDT\_row}}\ \mbox{\hyperlink{a05277_a20d7a6bb352e3f696c1c68bb394766d8}{kernel\_CS}};}
\DoxyCodeLine{\Hypertarget{a04367_source_l00060}\mbox{\hyperlink{a05277_ac8a5b4f6a3dc223e2eb6abebe19c9f08}{00060}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{a05273}{GDT\_row}}\ \mbox{\hyperlink{a05277_ac8a5b4f6a3dc223e2eb6abebe19c9f08}{kernel\_DS}};}
\DoxyCodeLine{\Hypertarget{a04367_source_l00061}\mbox{\hyperlink{a05277_a32508694f9db3188cd4aba126cbfb5bb}{00061}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{a05273}{GDT\_row}}\ \mbox{\hyperlink{a05277_a32508694f9db3188cd4aba126cbfb5bb}{user\_CS}};}
\DoxyCodeLine{\Hypertarget{a04367_source_l00062}\mbox{\hyperlink{a05277_a73463d83e2048869692d0adf1acac7a6}{00062}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{a05273}{GDT\_row}}\ \mbox{\hyperlink{a05277_a73463d83e2048869692d0adf1acac7a6}{user\_DS}};}
\DoxyCodeLine{\Hypertarget{a04367_source_l00063}00063\ }
\DoxyCodeLine{\Hypertarget{a04367_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{a04367_source_l00065}00065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{a05277_aa061ecab5a20a3556413fbbde4fe89d7}{GDT}}();}
\DoxyCodeLine{\Hypertarget{a04367_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{a05277_a9b61f75de7fa2ffe9589f43c3f6a6a6c}{\string~GDT}}();}
\DoxyCodeLine{\Hypertarget{a04367_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{a05277_af8e3c1da270077eb7cc6551b35c0e5ca}{installTable}}();}
\DoxyCodeLine{\Hypertarget{a04367_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{a05277_a9c89bddfdb21d5cc09c1d82411982de9}{printLoadedTable}}();}
\DoxyCodeLine{\Hypertarget{a04367_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{a05277_a2ae998750fc1e18e6778e92774bd3574}{printLoadedTableHeader}}();}
\DoxyCodeLine{\Hypertarget{a04367_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ uint16\_t\ \mbox{\hyperlink{a05277_a89a8d2c17e3c22e7200bff09252f46e1}{kernel\_CS\_selector}}();}
\DoxyCodeLine{\Hypertarget{a04367_source_l00071}00071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ uint16\_t\ \mbox{\hyperlink{a05277_a34661a528b1630bff806e25411ad6ec3}{kernel\_DS\_selector}}();}
\DoxyCodeLine{\Hypertarget{a04367_source_l00072}00072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ uint16\_t\ \mbox{\hyperlink{a05277_a8806a14009c4f0432d4b7043d687be17}{user\_CS\_selector}}();}
\DoxyCodeLine{\Hypertarget{a04367_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ uint16\_t\ \mbox{\hyperlink{a05277_a90661f97e9cf214dd6d977b19c01f7fc}{user\_DS\_selector}}();}
\DoxyCodeLine{\Hypertarget{a04367_source_l00074}00074\ \ \ \ \ \ \ \ \ \}\ \mbox{\hyperlink{a04340_a4bbf25084dee10ec29f4356cacced463}{\_\_attribute\_\_}}((packed));}
\DoxyCodeLine{\Hypertarget{a04367_source_l00075}00075\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{a04367_source_l00076}00076\ }
\DoxyCodeLine{\Hypertarget{a04367_source_l00077}00077\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
